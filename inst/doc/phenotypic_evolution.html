<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Stratigraphic Paleobiology for Phenotypic Evolution</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Stratigraphic Paleobiology for Phenotypic
Evolution</h1>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Here we describe the modeling pipeline for the stratigraphic
paleobiology of phenotypic evolution. For details how this can be
combined with the <code>paleoTS</code> package (<a href="#References">Hunt 2006</a>), see</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">vignette</span>(<span class="st">&quot;paleoTS_functionality&quot;</span>)</span></code></pre></div>
<p>First, let’s load all required packages:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(StratPal)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">library</span>(admtools)</span></code></pre></div>
</div>
<div id="modes-of-evolution-in-the-time-domain" class="section level2">
<h2>Modes of evolution in the time domain</h2>
<div id="implemented-modes-of-evolution" class="section level3">
<h3>Implemented modes of evolution</h3>
<p>The <code>StratPal</code> package provides three functions for
simulating different modes of evolution in the time domain:</p>
<ul>
<li><p><code>stasis</code> simulates evolutionary stasis as independent,
normally distributed random variables with mean <code>mean</code> and
standard deviation <code>sd</code> (<a href="#References">Hunt
2006</a>).</p></li>
<li><p><code>random_walk</code> simulates trait evolution following a
(potentially biased) random walk with variability <code>sigma</code>,
directionality <code>mu</code>, and initial trait value <code>y0</code>
(e.g. <a href="#References">Bookstein 1987</a>). Setting <code>mu</code>
to a negative (positive) value will make the value of the random walk
decrease (increase) over time, <code>sigma</code> determines the effect
of randomness on the trait values.</p></li>
<li><p><code>ornstein_uhlenbeck</code> corresponds to convergence to a
phenotypic optimum, where <code>mu</code> is the optimal value (long
term mean), <code>theta</code> determines how fast <code>mu</code> is
approached, <code>sigma</code> the noise level, and <code>y0</code> the
initial trait value (<a href="#References">Lande 1976</a>).</p></li>
</ul>
<p>Use <code>vignette(&quot;advanced_functionality&quot;)</code> for guidelines to
implement your own modes of evolution.</p>
</div>
<div id="visualization" class="section level3">
<h3>Visualization</h3>
<p>You can visualize the different modes of evolution using the
following pipeline:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>) <span class="sc">|&gt;</span>             <span class="co"># times of simulation in Myr. Simulate over 1 Myr years with 10 kyr resolution</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="fu">random_walk</span>(<span class="at">sigma =</span> <span class="dv">1</span>, <span class="at">mu =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> <span class="co"># simulate random walk with increasing trait values</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">type =</span> <span class="st">&quot;l&quot;</span>,                  <span class="co"># plot results</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;Time [Myr]&quot;</span>,</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&quot;Trait value&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAclBMVEUAAAAAADoAAGYAOpAAZmYAZrY6AAA6ADo6AGY6Ojo6OpA6kNtmAABmADpmAGZmZgBmkJBmtrZmtv+QOgCQOjqQZgCQkGaQ27aQ2/+2ZgC2/7a2/9u2///bkDrb2//b/9vb////tmb/25D//7b//9v///9xbNdRAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIhUlEQVR4nO2diXajNgBFNeM6mY6TLnGX0IaOsc3//2KRABthxJOEQCK8e85kTIIW36MdAaIko4jYGUgdCgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQECCxIrIZYgsJGNx8UBKAgAAUNcm96Fhbk3vZFQdy/L0vQEKK85ZCChqCgccTDT+tAtlyPdUvz9SNIdEtSNY/dzM0jKBeH+kPRfpgU3ZKIbhdWziToerxpyXenydEtSj9jswi6vLy1HwtDJUtV0EO+WIJ0lhFUtUFNEVpdG7SQoKqS1b2YofwkK+gxWxwHaVDQOAO5mltQvqpeLIKgfixpz+YDCapa4N0pM3RP/llJgDCCii/v1ejm8jLJUJKChjLlLkiOAuXwz9S63CmE+PLukJfohBEk5xFSkGkSociEOJy/n7qTDs90lyRsCcqMg8BS/S1TpWdNU43BPHm3QbfZxACq3JyfpaA1TVZDCarnEcbWRZ0gG/Drf+WaSpBh5DHTZLUtN8a+buOCyrwuYIWxHiYnyJQhn15MgPXmKfmJRjhBDaO9vHt00QkuqMz2vnlxSncZzHNDf0HTilBkQb1rXsKcH39BeKrhFN2yqBJjtUPBW9DlZe+YKRVLGssdorm4bHF52b8XG5lpuEQXBdHYaRSFFRSG6ILaMtR+HDvVOs6ARBUkOp8EyMvmBY31YPq5VpHehtFrHkmL3hFL0Hja41nZoKB+0sEFtdVsXVXMZlA4Gs7+xGx3yvfl+cm8ohgy3UB47Ot1PL0zUDyUhbyqMWmkGE2Qa8J+VzXO3z7UP38WFnQf7cwvSF7VuLy+r0pQZ7g8vyA1jc8O66li2nzCOV2fbj7by55sLSuK2pzdPdmFx0HLL3do04r0Bc0VnU1CaFqKwtue6LdS5p1uwIS8yq3PQBFcVw2bbsB0vNL0q2KFbEX2xnPr66lFCvdqTE7Huw26Hs3dmBKkhgHRt79EEmRRgho1sTcvRBCk7nQab4OkoGYyG3v7SwRBFr3YtkuQBfWK0b6Ms/1F69hDxhboxJrKUVUNjfeyzCios8YcYsD+6UbS+sR9c4JwsEZQsOmeRyP9Wvdgdrs7wt6rIcZalc56RsC5sL8gr90dE2fzo5VG3H6ELO6ugrL7V1z+VoSOgoGo1P3cwds2/xK0ULoPYfohxe33YrQGerKmRnpwVVm07XKQPsuYaMATZ4tOdP4X2i/FeOs9CUdB1cjYYhuwxRaHKUtXon8ZcIam5zHVYCdKxtZCPKLrBek0xoO1LigzVbHrcR8yul6IeyWbf87rIchq84L5JgTHdE0hQo6WHZK1OTHO5oXH4c8yKyY+60FRNi8stYDknW5HUIzNC7H8eC25xti8sCJBcTYvrElQlM0LqxI0JTnP5Y5ofjzboAXTrc9ekyDjxdJ50nU+OTAeVWzizZiO6TqfHBifErT0rQgx/aS/HjTTOpg1KxAU1Y/7glmIFtoyXbWqQUHmU25rzTFJVpAQ3btK45GqoNnXmm1xFrTMHYftWvMKBc1agsT4n2OQlKDb5Yp0/CQnCN7HvjQLCxpf7mh7rRULmjXd9lJXSn4SFJRC19UhQUFpMZMgn/dqJOlnJkFe79XYkCC/tyJsSJDXezXS9JNQCdqSII/3aiQ2+rkzUy/m9F6NenfqtgS5RCfKWTY4ByK6oHZ2ulVB4F6NtKYVQyxcgnqz+eT1JFDFUoeCAAlNVtMkoclqmkSbaqyGOQRZTFbtIrW7ehYn9imnW5Qgu0g/qyCLyapdpJ9WkO1TubcrKFCkFDTt7xREQdP+TkGbF/SZoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQYCQgoru85YL5wfA90OMvdgdBc+FAE86siWgoEI+BrfNo3bgHlweu72PUgueqyfyBjEUTlB9Uah50a924B68VNcHXAT1Ut87pm4mnKD62VXNxiHtwD24/LT700WQFjxRQc+yfDeXXLUD9+Dq0KkN0oMnWcXqBqBpBrQD9+CqxjgJ6iXo3kWYSFSQvLQ9QVBWlaTzU4jH2SRaxdSBfxVzbwHNpNlI580eFftWRAvuXn7NJNvNO5YgLXhtK8jzfhIeKDqOpLXgSbZBqmLIHNajkNy5H9GCl85TDS24fMJ6ED+crCIoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBgMiC7m8U+mf0md/nJ7H7cWwut/f2v16PoXaTDZFACar3PoFznt6kiFpM1t//GmYn0DCrEvSTeuX75ZdftyhIvcb06feqyh2q+qT2luX3PSy1oH0mDwu5QVhtlcr3l9e/xNePDQmqvmkun5Am99LJvbztLqhGkHxTbpkdst1Jbh+7Ht8uL/I3GxJ0KNsfb/LVwdq2zEqQfAns5VXuoFanP783J21H0Ft5+1F/6+bd042gqszI9y3LvWdVHctrT5sV1N3p2giqWh35slwpqCpa1adNC+p+61bQ+du/f7wrQZfXv6s+bcuCtLfFtIKux9+qZkgKuh5/lpo2LEj1YmVWf/dWUDVI3Df7X9VTLzctSI2Dms3gN0HqHh4lSAXbhCAbms5M+9X323CagoYE5feN4hSkZvMn/Re3408/m08bCgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFAT4H4vqz1IZ+V1MAAAAAElFTkSuQmCC" alt="plot of a random walk" /></p>
<p><strong>Task:</strong> Modify the pipeline to get an intuition for
the different modes of evolution. What are the effects of their
parameters, and what is their biological meaning?</p>
</div>
</div>
<div id="stratigraphic-domain" class="section level2">
<h2>Stratigraphic domain</h2>
<p>We are interested in how phenotypic evolution is preserved in the
stratigraphic record, i.e. how trait evolution within a lineage is
preserved at a specific location in the stratigraphic record. Here we
develop the modeling pipelines to answer this question.</p>
<div id="age-depth-models" class="section level3">
<h3>Age-depth models</h3>
<p>As an example, we compare the preservation of trait evolution 2 km
and 12 km offshore in the carbonate platform in scenario A from <a href="#References">Hohmann et al. (2024)</a>. See
<code>?scenarioA</code> and <code>vignette(&quot;StratPal&quot;)</code> for
details on scenario A.</p>
<p>First define the age-depth models:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>adm_2km <span class="ot">=</span> <span class="fu">tp_to_adm</span>(<span class="at">t =</span> scenarioA<span class="sc">$</span>t_myr,    <span class="co"># 2 km from shore</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>                <span class="at">h =</span> scenarioA<span class="sc">$</span>h_m[,<span class="st">&quot;2km&quot;</span>],</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>                <span class="at">T_unit =</span> <span class="st">&quot;Myr&quot;</span>,</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>                <span class="at">L_unit =</span> <span class="st">&quot;m&quot;</span>)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>adm_12km <span class="ot">=</span> <span class="fu">tp_to_adm</span>(<span class="at">t =</span> scenarioA<span class="sc">$</span>t_myr,   <span class="co"># 12 km from shore</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>                <span class="at">h =</span> scenarioA<span class="sc">$</span>h_m[,<span class="st">&quot;12km&quot;</span>],</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>                <span class="at">T_unit =</span> <span class="st">&quot;Myr&quot;</span>,</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>                <span class="at">L_unit =</span> <span class="st">&quot;m&quot;</span>)</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="fu">plot</span>(adm_2km,       <span class="co"># plot age-depth model 2 km from shore</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>     <span class="at">lwd_acc =</span> <span class="dv">2</span>,   <span class="co"># plot thicker lines for intervals with sediment accumulation (lwd = line width)</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>     <span class="at">lty_destr =</span> <span class="dv">0</span>) <span class="co"># don&#39;t plot destructive intervals/gaps (lty = line type)</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="fu">T_axis_lab</span>()        <span class="co"># add time axis label</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="fu">L_axis_lab</span>()        <span class="co"># add length axis label</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;Age-depth model 2 km from shore&quot;</span>)</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="fu">plot</span>(adm_12km,      <span class="co"># plot age-depth model 12 km from shore</span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>     <span class="at">lwd_acc =</span> <span class="dv">2</span>,   </span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a>     <span class="at">lty_destr =</span> <span class="dv">0</span>) </span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="fu">T_axis_lab</span>() </span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a><span class="fu">L_axis_lab</span>() </span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;Age-depth model 12 km from shore&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAzFBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmAGZmOgBmOjpmZgBmZjpmkJBmkLZmkNtmtrZmtttmtv+QOgCQOjqQZgCQZjqQkGaQtpCQttuQtv+Q27aQ29uQ2/+2ZgC2Zjq2ZpC2kDq227a229u22/+2/7a2/9u2///bkDrbkGbbtmbbtpDb25Db29vb/7bb/9vb////tmb/25D/27b//7b//9v///8MwOajAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALfUlEQVR4nO2deZ+jxhGGmfEoUjy+otnsOteO4iuJ2DiZeLCdxEIj8f2/k/ugDxD0C6gQPaLeP/STRFHdPOou+lKTFKygkqkzELsYEBADAmJAQAwIiAEBMSAgBgTEgIAYEBADAmJAQAwIiAEBMSAgBgTEgIAYEBADAmJAQAwIiAEBMSAgBgTEgIAYEBADAmJAQAwIiAEBMSAgBgTkAcqT5Pa584lpyPj4T3EsS262vfNTc3vcJItd+f7lXZIknz51yoA698MqSb7onQMpL+seoFSk/9jZRyh/L29v6QHl4nKFrE8IKJfm6945kGoEdHgQ/padfYTyp4/RAhLvbrfFfmWBQUCD0j851QHKk5s/mDSPH5LkbquzIN/ffLFzZ8uie/dd/aD4/C9RB+6edFEUR0Uq/1B+yvPEL7D8+T65eV/8uDLf/ixO+ehPu1a3DtDh3WpZwaLeCZ+3T02Oy1zcbEUuvn0rjLy0mu2L4sd7ccLnTxqQyboDlCaL/650kRTZks7vyyxI3dlfSx9UCPyDafmtQG8BWTsDSOvefluaLHZtbv0Y5LDYd+KwSK/BsQ+oTMGl1WxvDHTht+8tIHHW2mRH1N7l7pgqg1TS369cZdYHP9QPSuun4idVS00VSxZP8nXtAK2lRfK+/FZXGP2+2W0dULWK/bBRUfPUcXnBsp7oXPzPT6vZXparnfx2Xcl64q5buCvrnr5AWXyfJTeVmAXdcjDVET4tL1AD0rl3OdA/n3g1UJVX75y62xogeWmPLh9f6qs7dVwF9OgVvVT7b7AX7+7+7QqTyboFlDpzkyvpbL+yVUeVzMUvGx3JawdNBjL3XmdQ/jDuJzKvleIhDY/NbquAXh4S9zG197QTx1VAysZPq9le13EdEL2sG0A2U5qtzWye1AD9v/mgAZRL9h0BmUPynJY0K4BkHt2n1IavLoBO0zqxf3mrE/1bIyATluT11UqQKdO2BDUdJChBTW59QFU+EtDie1MVCEqQRPTNvQnodUD2HuIFWRMPam2jloNNMQgACsQg49YDdHio8KlGEwioFoOaAckEv5J2p4CE3bLMkDhevYuJ9sLLg8tby0H/LuZnLQTo9C5Wd+sBSqt89BWrGt0JUPUu1mAvXP1uJ+tZYwkysV6/aWgHeY1S0+KpHvS+VY181VAEgPx2ULNbB8gGyUpDUR3vBKjaDmqy/2Dj6SkgXXAcaNke+exJl8qXr0XWPrd9RGH8/Sr56H39oGyWfF2+Vw3xpw6AdOv2z+1uHSAbJCuAlKNugFxabVXsJxmBPn0qGoN0k9JaKzYo2DV6pWoElKphAhOXumlWgExDpE9veFaAipd3K9Ox7ap5AWJZMSAgBgTEgIAYEBADAmJAQAwIiAEBMSAgBgTEgIAYEBADAmJAQAwIqB8gM312nWNjjeoFKHNzSMNWbr1C9QF03FgsWY/5jtetPoAOD3YmPp9NJeMSBNQzBpVFiGNQi8zqvtmUH24HQTEgoH53MRl5cm4otkkByvSqwO7/WXjl6guoRNN2m09ejcYCtF8pQLWGYv90p9ZogFAJ6uFuUo0ESJaRZWHC9ZnuJtUogArF6GYbaEjHD6iMAmMBurA7eiUMKCABx9xGGFCD/JssAzpVpREy4l1Mq6WzETcg/0Pns/okcdygTtjMAQlCYGl5xICSSwASLaBwLzVqQJVPnU8jzgWtO0oxoLASBhRWbaCBAdXFgIDmCqjzEN1MAQ0ew5wJoOFjvOcD8jte7X2vwemeLYVm+Bg4BSC/zdx1NcfFAJ07P3DtgM6eP7n2GHT2/BINIBOHus80XwjQ+RNwJICOm97LXC4DiGCCkgTQgBn48QElJHyoSlDvdWRjA1JsKCa4aWLQ/rd9NyIcHxCVIxJDsyVNNEGabnUEURXrsblJz3SHiW71yJUG6cgARRekCdcfXWeQJlyfRVTF+nXl+6Q7SLEBGjPdQc6jAtSrN3+ZNYqU3q9yuCM2QLGNKJKWz2uMQaT199oAUfVRnUNyw0ncWbfk0f/qAJF7JDecxJ11Gyegwxvd0+jxD95xAI3QviIFlE0PiN7l+YapawR179TPCZArQWOk28tprIDGTLeX0xG80gDqv5fJzAClvf+8OwagUcYIiAbMohhyHWUM5ZoG7eMFFMe0zzijcFQTh32L0CiA6H1SD5hNdhcjH+VwnskNp3A34hj3tQAidVdxTWHo1bKusWhegMr/x+fykWUdW0SkVzTmLBLpbT5b7LruWUYMiNJbzTeFoWko5rfPk8yLRQ/IrO6QJWgCQKPO0xLHIFPZYPeeFhChsxPnNIbqPiafqaeJ4K1K5waoqg4bTVJODr8+QB22KiUFROerwTu5YUFUgob+RZBYFJ3V9ckKM7xVKUw3lm3ORuqLwa1KkbtY+ETbWY2FD+FtfrFLcT+syxK8M/9DSSyihuLNNpMPwrUPjIdblba7i6ZyaZF1NeTtyvQzOmxV2uouMj50nVXJI/cADdxoMjY+tCUoLWm0b1UK3cXGhzQG2dbP8BIUXQEi7azaBxoP3qo0Pj6jtYMGbVUaIZ+4GooR8olq4jDGAkQXg3rOPTe4i5JPRIDi5BMVoH4eLqRoAEVagKIBFCufWABFyyceQP1Ov5ziABRvAYqjoRgxnxi6GmP/B/o8TQ5o9P+In6kIANE6phYDApoaUNz1q4gBEK1fcjEgIAYENDGg6EPQ9IBo3dKLAQExIKBpAcUfgsYC1HGddPx8RgLUdZ30XAF1XuU6V0Dt66RrS/DmCuiyK+3H1Vgx6Ox10rFopLvY2euko9HUndXoNRmgV6OJAPVz2tFuErOB5rROGRCNHQOK0WygOa1TBkRjx4BiNBtoTuuUAdHYXR+gaxIDAmJAQAwIiAEBMSAgBgTEgIAYEBADAmJAQAwIiAEBUQLKvU0Iqh/a7dxmBQ3af/zcdE67Wbs3tXDHTgeHvNVECCiXWw6YdCsfAnahB3EeHuwSiYA736zV23EjTs4MupC3uugA6aUN6fL0Q8Au9Nyg3C3UCrjzzdq96T1Zyn1+Qt5ORAeokofKh4BdkbVmM0/W9noD7nyzgDdtq0tNwNupCAGp4l1mtvIhYFeknyTtzw5ygNrdVb4PerPPCQl7q4kOkP55yh+p8iFgd3iQC0Xadkmz1xBw55uFvdlFO2FvNU0MqPwKFY2OgIA3P0ZPAGhYFdNftTyeoncVC3lzi74mqmLDgrT+quXu3CVIF6eAGr1lLjZNFKQH3eZ1XmHRCN+YaxwbvWXecwsmus0PayiqbMIgHW7aeXexNm/7lf/lNA1F+SupBrzevjxrb81X7OSTAtt2L1BXDt35Zm3eMr2s7GaLvdXEnVUgBgTEgIAYEBADAmJAQAwIaGJA7rkC/wnu5bRfJYtfNqY3Xv2vyHHTuVEzQBGUoNCoq7URnQgBQoNJ63+m6doqHqJXBeg36uHTh99/OUdA8u+M+9VfRJVbi/qk+guZGx7UgJaqm5UvvlrsVK8rWx7efJPcPs8IkJp7EF0rORaRiQ+mk1kCyvWIYbrYyf7XcfOoxxBnBGhdmJfysYG5G18SgOQM2OHNNpWPaniUJ5ZG8wH0WNgXfdXl8GAJSJQZUcN2cpN9UccyzWm2gMoGgA9IzuuIOJTqRzWkZov9mQLyr9oA2n/8w1+3CtDhzd/FPW3OgCq7gBpAx80fRRiSgI6bTySmGQNSd7EidZOhajAwlXM36kEfahR+1oBUO6gcbraAchmTFCB12iwAdVHDXNf+M9ucZkBNgDI3T8GAVG9+V/3Cfr763nzcYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMC+hXek1JutoSLQAAAAABJRU5ErkJggg==" alt="2 plots of age-depth models, one 2 km from shore and one 12 km from shore" width="50%" /><img src="data:image/png;base64,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" alt="2 plots of age-depth models, one 2 km from shore and one 12 km from shore" width="50%" /></p>
</div>
<div id="stratigraphic-expression-of-phenotypic-evolution" class="section level3">
<h3>Stratigraphic expression of phenotypic evolution</h3>
<p>We use the defined age-depth models to transform the simulated trait
values from the time domain into the depth domain via
<code>time_to_strat</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min_time</span>(adm_2km), <span class="at">to =</span> <span class="fu">max_time</span>(adm_2km), <span class="at">by =</span> <span class="fl">0.01</span>) <span class="sc">|&gt;</span> <span class="co"># sample every 10 kyr over the interval covered by the adm </span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="fu">random_walk</span>(<span class="at">sigma =</span> <span class="dv">1</span>, <span class="at">mu =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span>                                 <span class="co"># simulate random walk</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="fu">time_to_strat</span>(adm_2km, <span class="at">destructive =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span>                    <span class="co"># transform data from time to strat domain</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">type =</span> <span class="st">&quot;l&quot;</span>,                                                  <span class="co"># plot</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>       <span class="at">orientation =</span> <span class="st">&quot;lr&quot;</span>,</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="fu">paste0</span>(<span class="st">&quot;Stratigraphic height [&quot;</span>, <span class="fu">get_L_unit</span>(adm_2km), <span class="st">&quot;]&quot;</span>),</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&quot;Trait value&quot;</span>,</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>       <span class="at">main =</span> <span class="st">&quot;Trait evolution 2 km from shore&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" alt="plot of the stratigraphic experssion of a random walk 2 km from shore." /></p>
<p>This is what a biased random walk in the time domain would look like
if it was observed 2 km offshore in the simulated carbonate platform.
The large jumps in traits correspond to long hiatuses caused by
prolonged drops in relative sea level (<a href="#References">Hohmann et
al. 2024</a>). Compare this figure to the random walk in the time domain
(without stratigraphic distortions).</p>
<p>12 km offshore, the preservation is very different:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min_time</span>(adm_12km), <span class="at">to =</span> <span class="fu">max_time</span>(adm_12km), <span class="at">by =</span> <span class="fl">0.01</span>) <span class="sc">|&gt;</span> <span class="co"># sample every 10 kyr over the interval covered by the adm </span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  <span class="fu">random_walk</span>(<span class="at">sigma =</span> <span class="dv">1</span>, <span class="at">mu =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span>                                   <span class="co"># simulate random walk</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  <span class="fu">time_to_strat</span>(adm_12km, <span class="at">destructive =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span>                     <span class="co"># transform data from time to strat domain</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">type =</span> <span class="st">&quot;l&quot;</span>,                                                    <span class="co"># plot results</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>       <span class="at">orientation =</span> <span class="st">&quot;lr&quot;</span>,</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="fu">paste0</span>(<span class="st">&quot;Stratigraphic height [&quot;</span>, <span class="fu">get_L_unit</span>(adm_12km), <span class="st">&quot;]&quot;</span>),</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&quot;Trait value&quot;</span>,</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>       <span class="at">main =</span> <span class="st">&quot;Trait evolution 12 km from shore&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" alt="plot of the stratigraphic expression of a random walk 12 km from shore." /></p>
<p>You can also see two jumps, but the first is at a different location
compared to the section 2 km offshore. Looking at the age-depth models,
we can see why this is: 2 km offshore, the jumps are caused by prolonged
hiatuses that are associated with the massive drops in sea level around
0.5 Myr and 1.5 Myr. 12 km offshore, the age-depth model shows fewer
gaps, but prolonged intervals with low sedimentation rates at the
beginning of the simulation and at around 1.5 Myr. This leads to
intervals where the rate phenotypic evolution appears to be accelerated
because of (sedimentological) condensation (<a href="#References">Hohmann 2021</a>). You can see that not all
artefactual jumps in traits observable in the stratigraphic record are
caused by gaps.</p>
<p><strong>Task:</strong> How does this effect vary between different
modes of evolution (with different parameter choices), and at different
locations in the platform (e.g., along an onshore-offshore gradient)?
Can you make any general statements about where you see the strongest
effects?</p>
</div>
<div id="prescribing-a-sampling-strategy" class="section level3">
<h3>Prescribing a sampling strategy</h3>
<p>The above plots already give us a good idea of how stratigraphic
effects can change our interpretation of trait evolution.</p>
<p>However, there is a small imperfection. Because we simulate the
lineage every 10 kyr, it is sampled irregularly in the stratigraphic
domain: If sedimentation rates are high, samples can be multiple meters
apart, but if sedimentation rates are low, they are only a few
centimeters apart.</p>
<p>To fix this, we want to prescribe where in the stratigraphic domain
samples are taken. This allows us to examine the effect that different
sampling strategies have on our perception of trait evolution. We do
this in the following steps:</p>
<ol style="list-style-type: decimal">
<li>Determine sampling locations in the stratigraphic domain.</li>
<li>Calculate what times correspond to said sampling locations via
<code>strat_to_time</code>.</li>
<li>Simulate a lineage at said times.</li>
<li>Transform the simulated trait values back into the stratigraphic
domain using <code>time_to_strat</code>.</li>
<li>Plot the result.</li>
</ol>
<p>Let’s assume we take a sample every 2 meters. Then our five steps
above result in the following modeling pipeline:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>dist_between_samples_m <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>sampling_loc_m <span class="ot">=</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fl">0.5</span> <span class="sc">*</span> dist_between_samples_m,</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>                     <span class="at">to =</span> <span class="fu">max_height</span>(adm_2km),</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>                     <span class="at">by =</span> dist_between_samples_m)</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>sampling_loc_m <span class="sc">|&gt;</span>                                  <span class="co"># sampling locations</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>  <span class="fu">strat_to_time</span>(adm_2km) <span class="sc">|&gt;</span>                        <span class="co"># determine times where lineage is sampled</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>  <span class="fu">random_walk</span>(<span class="at">sigma =</span> <span class="dv">1</span>, <span class="at">mu =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span>                <span class="co"># simulate trait values at these times</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>  <span class="fu">time_to_strat</span>(adm_2km, <span class="at">destructive =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span>   <span class="co"># transform trait values to stratigraphic domain</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">orientation =</span> <span class="st">&quot;lr&quot;</span>,                         <span class="co"># plot stratigraphic data</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>       <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,        </span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&quot;Trait Value&quot;</span>,</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="fu">paste0</span>(<span class="st">&quot;Stratigraphic height [&quot;</span>, <span class="fu">get_L_unit</span>(adm_2km), <span class="st">&quot;]&quot;</span>),</span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>       <span class="at">main =</span> <span class="st">&quot;Trait evolution 2 km from shore&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" alt="plot of the stratigraphic expression of a random walk 2 km from shore, sampled every 2 km." /></p>
<p>There we have it! This is what the lineage would look like if it was
sampled every 2 meters in a sections 2 km from shore.</p>
<p><strong>Task:</strong> How does prescribing a sampling strategy
change the interpretations of your last task? Can you draw any
conclusions about which sampling strategy is best suited for a given
environment or mode of evolution?</p>
</div>
</div>
<div id="further-reading" class="section level2">
<h2>Further reading</h2>
<p>For details on how the <code>StratPal</code> package (<a href="#References">Hunt 2006</a>) can be integrated with the
<code>paleoTS</code> package, see</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">vignette</span>(<span class="st">&quot;paleoTS_functionality&quot;</span>)</span></code></pre></div>
<p>Run</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">vignette</span>(<span class="st">&quot;event_data&quot;</span>)</span></code></pre></div>
<p>for details on how to model stratigraphic paleobiology of event data
such as individual fossils and first/last occurrences of taxa, or
explore the vignette online under <a href="https://mindthegap-erc.github.io/StratPal/articles/event_data.html">mindthegap-erc.github.io/StratPal/articles/event_data</a>.</p>
<p>See also</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">vignette</span>(<span class="st">&quot;advanced_functionality&quot;</span>)</span></code></pre></div>
<p>for details on how to expand on the modeling pipelines described
here, or explore the vignette online under <a href="https://mindthegap-erc.github.io/StratPal/articles/advanced_functionality.html">mindthegap-erc.github.io/StratPal/articles/advanced_functionality</a>.</p>
</div>
<div id="References" class="section level2">
<h2>References</h2>
<ul>
<li><p>Bookstein, Fred L. 1987. “Random walk and the existence of
evolutionary rates.” Paleobiology. <a href="https://doi.org/10.1017/S0094837300009039" class="uri">https://doi.org/10.1017/S0094837300009039</a>.</p></li>
<li><p>Hohmann, Niklas. 2021. “Incorporating information on varying
sedimentation rates into paleontological analyses.” PALAIOS. <a href="https://doi.org/10.2110/palo.2020.038" class="uri">https://doi.org/10.2110/palo.2020.038</a>.</p></li>
<li><p>Hohmann, Niklas; Koelewijn, Joël R.; Burgess, Peter; Jarochowska,
Emilia. 2024. “Identification of the mode of evolution in incomplete
carbonate successions”. BMC Ecology and Evolution 24, 113. <a href="https://doi.org/10.1186/s12862-024-02287-2" class="uri">https://doi.org/10.1186/s12862-024-02287-2</a>.</p></li>
<li><p>Hunt, Gene. 2006. “Fitting and Comparing Models of Phyletic
Evolution: Random Walks and Beyond.” Paleobiology. <a href="https://doi.org/10.1666/05070.1" class="uri">https://doi.org/10.1666/05070.1</a>.</p></li>
<li><p>Lande, Russell. 1976. “Natural selection and random genetic drift
in phenotypic evolution.” Evolution. <a href="https://doi.org/10.1111/j.1558-5646.1976.tb00911.x" class="uri">https://doi.org/10.1111/j.1558-5646.1976.tb00911.x</a></p></li>
</ul>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
