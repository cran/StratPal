<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Integration with the FossilSim and paleotree packages</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Integration with the FossilSim and
paleotree packages</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(StratPal)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(admtools)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co">#&gt; Warning: package &#39;admtools&#39; was built under R version 4.5.2</span></span></code></pre></div>
<p>This vignette describes how to integrate the <code>StratPal</code>
package with the <code>FossilSim</code> and the <code>paleotree</code>
packages.</p>
<div id="integration-with-the-fossilsim-package" class="section level2">
<h2>Integration with the <code>FossilSim</code> package</h2>
<p>As is, the <code>StratPal</code> package handles <code>fossils</code>
objects as constructed by the <code>FossilSim</code> package. These
objects represent fossils sampled along a tree (phylogeny). They can be
transformed using the functions <code>apply_taphonomy</code> and
<code>apply_niche</code>. This will remove fossil occurrences according
to preservation potential and change on taphonomic conditions (or niche
definition and change in gradient). Note that this corresponds to an
nonparametric expansion of the variable recovery model as implemented in
<code>FossilSim</code>.</p>
<p>As example, we examine the preservation of a phylogenetic tree with
taxonomy and sampled fossils 12 km from shore in a carbonate
platform.</p>
<div id="stratigraphic-basis" class="section level3">
<h3>Stratigraphic basis</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># construct age-depth model</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>adm_12km <span class="ot">=</span> <span class="fu">tp_to_adm</span>(<span class="at">t =</span> scenarioA<span class="sc">$</span>t_myr,   <span class="co"># 12 km from shore</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>                <span class="at">h =</span> scenarioA<span class="sc">$</span>h_m[,<span class="st">&quot;12km&quot;</span>],</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>                <span class="at">T_unit =</span> <span class="st">&quot;Myr&quot;</span>,</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>                <span class="at">L_unit =</span> <span class="st">&quot;m&quot;</span>)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="fu">plot</span>(adm_12km, <span class="at">lty_destr =</span> <span class="dv">0</span>,</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Age-depth model 12 km from shore&quot;</span>,</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>     <span class="at">lwd_destr =</span> <span class="dv">3</span>)</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="fu">T_axis_lab</span>()</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="fu">L_axis_lab</span>()</span></code></pre></div>
<p><img role="img" aria-label="Age-depth model and water depth 12 km offshore (proximal slope)" src="data:image/png;base64,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" alt="Age-depth model and water depth 12 km offshore (proximal slope)" /></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co"># water depth 12 km from shore</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>t <span class="ot">=</span> scenarioA<span class="sc">$</span>t_myr</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>wd <span class="ot">=</span> scenarioA<span class="sc">$</span>wd_m[,<span class="st">&quot;12km&quot;</span>]</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>gc <span class="ot">=</span> <span class="fu">approxfun</span>(t, wd)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="fu">plot</span>(t, <span class="fu">gc</span>(t),</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Time [Myr]&quot;</span>,</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Water depth [m]&quot;</span>,</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img role="img" aria-label="Age-depth model and water depth 12 km offshore (proximal slope)" src="data:image/png;base64,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" alt="Age-depth model and water depth 12 km offshore (proximal slope)" /></p>
</div>
<div id="trees-with-fossils" class="section level3">
<h3>Trees with fossils</h3>
<p>For the biological components, we simulate a tree with taxonomy and
fossils in the time domain using <code>FossilSim</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co"># simulate phylogenetic tree</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>tree <span class="ot">=</span> ape<span class="sc">::</span><span class="fu">rbdtree</span>(<span class="at">birth =</span> <span class="dv">3</span>, <span class="at">death =</span> <span class="dv">1</span>, <span class="at">Tmax =</span> <span class="fu">max_time</span>(adm_12km))</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co"># simulate taxonomy along the tree</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>s <span class="ot">=</span> FossilSim<span class="sc">::</span><span class="fu">sim.taxonomy</span>(<span class="at">tree =</span> tree)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co"># simulate fossils based on taxonomy</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>sampling_rate <span class="ot">=</span> <span class="dv">40</span> <span class="co"># high sampling rate</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>f <span class="ot">=</span> FossilSim<span class="sc">::</span><span class="fu">sim.fossils.poisson</span>(<span class="at">rate =</span> sampling_rate, <span class="at">taxonomy =</span> s)</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co"># plot tree with taxonomy and fossil times</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>FossilSim<span class="sc">:::</span><span class="fu">plot.fossils</span>(f, <span class="at">tree =</span> tree, <span class="at">taxonomy =</span> s, <span class="at">show.taxonomy =</span> <span class="cn">TRUE</span>, <span class="at">rho =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img role="img" aria-label="Phylogenetic tree with sampled fossils" src="data:image/png;base64,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" alt="Phylogenetic tree with sampled fossils" /></p>
</div>
<div id="ecological-effects" class="section level3">
<h3>Ecological effects</h3>
<p>Lets assume all taxa have identical niches and a preferred water
depth of around 60 m, and are rather tolerant to fluctuations in water
depth:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># define niche</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>my_niche <span class="ot">=</span> <span class="fu">snd_niche</span>(<span class="at">opt =</span> <span class="dv">60</span>, <span class="at">tol =</span> <span class="dv">40</span>, <span class="at">cutoff_val =</span> <span class="dv">0</span>)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co"># plot niche</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>wd_p <span class="ot">=</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> wd_p,</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>     <span class="at">y =</span> <span class="fu">my_niche</span>(wd_p),</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Water depth [m]&quot;</span>,</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Collection probability&quot;</span>,</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Collection probability with water depth&quot;</span>,</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img role="img" aria-label="Niche of taxa and collection probability with time" src="data:image/png;base64,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" alt="Niche of taxa and collection probability with time" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> <span class="fu">get_T_tp</span>(adm_12km),</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>     <span class="at">y =</span> adm_12km <span class="sc">|&gt;</span> <span class="fu">get_T_tp</span>() <span class="sc">|&gt;</span> <span class="fu">gc</span>() <span class="sc">|&gt;</span> <span class="fu">my_niche</span>(),</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Time [Myr]&quot;</span>,</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Collection probability&quot;</span>,</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Collection probability with time&quot;</span>,</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img role="img" aria-label="Niche of taxa and collection probability with time" src="data:image/png;base64,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" alt="Niche of taxa and collection probability with time" /></p>
<p>After accounting for niches, the tree with niches looks like</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>f_niche <span class="ot">=</span> f <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  <span class="fu">rev_dir</span>(<span class="at">ref =</span> <span class="fu">max_time</span>(adm_12km)) <span class="sc">|&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="fu">apply_niche</span>(<span class="at">niche_def =</span> my_niche, <span class="at">gc =</span> gc) <span class="sc">|&gt;</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="fu">rev_dir</span>(<span class="at">ref =</span> <span class="fu">max_time</span>(adm_12km))</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co"># plot tree after accounting for taxon niches</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>FossilSim<span class="sc">:::</span><span class="fu">plot.fossils</span>(f_niche, tree, <span class="at">taxonomy =</span> s, <span class="at">show.taxonomy =</span> <span class="cn">TRUE</span>, <span class="at">rho =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img role="img" aria-label="Tree with fossils after accounting for niche preference" src="data:image/png;base64,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" alt="Tree with fossils after accounting for niche preference" /></p>
<p>Note that although there are many more lineages present at the end of
the simulation, there are fewer fossils recovered. This is because the
water depth is too low (the platform is drowning) to actually observe
the taxa. Note that the <code>apply_niche</code> function is only
applied to the <code>fossils</code> object and not to the tree and the
taxonomy object, as they are not influenced by niche preferences.</p>
</div>
<div id="stratigraphic-effects" class="section level3">
<h3>Stratigraphic effects</h3>
<p>Now let us examine how the tree would be observed in the
stratigraphic domain:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="do">## transform tree, fossils, and taxonomy into stratigraphyc domain</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co"># using the age-depth model</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>tree_strat <span class="ot">=</span> <span class="fu">time_to_strat</span>(tree, adm_12km) <span class="co"># no transformation of time to age required</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>s_strat <span class="ot">=</span> s <span class="sc">|&gt;</span>  <span class="co"># taxonomy object in the time domain</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  <span class="fu">rev_dir</span>(<span class="at">ref =</span> <span class="fu">max_time</span>(adm_12km)) <span class="sc">|&gt;</span> <span class="co"># convert age to time</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>  <span class="fu">time_to_strat</span>( adm_12km , <span class="at">destructive =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> <span class="co"># transform using age-depth model</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>  <span class="fu">rev_dir</span>(<span class="at">ref =</span> <span class="fu">max_height</span>(adm_12km)) <span class="co"># transform back into age</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>f_strat <span class="ot">=</span>  f <span class="sc">|&gt;</span> <span class="co"># same here</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>  <span class="fu">rev_dir</span>(<span class="at">ref =</span> <span class="fu">max_time</span>(adm_12km )) <span class="sc">|&gt;</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>  <span class="fu">time_to_strat</span>( adm_12km , <span class="at">destructive =</span> <span class="cn">TRUE</span>)<span class="sc">|&gt;</span> <span class="co"># destroy fossils coinciding with gaps</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>  <span class="fu">rev_dir</span>(<span class="at">ref =</span> <span class="fu">max_height</span>(adm_12km ))</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>FossilSim<span class="sc">:::</span><span class="fu">plot.fossils</span>(f_strat, </span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>                         <span class="at">tree =</span> tree_strat,</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>                         <span class="at">taxonomy =</span> s_strat,</span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>                         <span class="at">show.taxonomy =</span> <span class="cn">TRUE</span>, </span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a>                         <span class="at">rho =</span> <span class="dv">0</span>,</span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a>                         <span class="at">show.axis =</span> <span class="cn">FALSE</span>)</span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>)</span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="fu">mtext</span>(<span class="dv">1</span>, <span class="at">text =</span> <span class="st">&quot;Stratigraphic position [m]&quot;</span>, <span class="at">line =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img role="img" aria-label="Tree with fossils in the stratigraphic domain" src="data:image/png;base64,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" alt="Tree with fossils in the stratigraphic domain" /></p>
<p>The accumulation of fossils on the right side is due to the
stratigraphic condensation observable at 12 m height in the age-depth
model.</p>
</div>
<div id="combined-stratigraphic-and-ecological-effects" class="section level3">
<h3>Combined stratigraphic and ecological effects</h3>
<p>Naturally, both ecological and stratigraphic effects can be combined
by applying the niche model to the <code>fossils</code> object:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="do">## transform tree, fossils, and taxonomy into stratigraphyc domain</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co"># using the age-depth model</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>tree_strat <span class="ot">=</span> <span class="fu">time_to_strat</span>(tree, adm_12km) <span class="co"># no transformation of time to age required</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>s_strat <span class="ot">=</span> s <span class="sc">|&gt;</span>  <span class="co"># taxonomy object in the time domain</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>  <span class="fu">rev_dir</span>(<span class="at">ref =</span> <span class="fu">max_time</span>(adm_12km)) <span class="sc">|&gt;</span> <span class="co"># convert age to time</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>  <span class="fu">time_to_strat</span>( adm_12km , <span class="at">destructive =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> <span class="co"># transform using age-depth model</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>  <span class="fu">rev_dir</span>(<span class="at">ref =</span> <span class="fu">max_height</span>(adm_12km)) <span class="co"># transform back into age</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>f_strat <span class="ot">=</span>  f <span class="sc">|&gt;</span> <span class="co"># same here</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>  <span class="fu">rev_dir</span>(<span class="at">ref =</span> <span class="fu">max_time</span>(adm_12km )) <span class="sc">|&gt;</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>  <span class="fu">apply_niche</span>(<span class="at">niche_def =</span> my_niche, <span class="at">gc =</span> gc) <span class="sc">|&gt;</span> <span class="co"># apply niche model </span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>  <span class="fu">time_to_strat</span>( adm_12km , <span class="at">destructive =</span> <span class="cn">TRUE</span>)<span class="sc">|&gt;</span> <span class="co"># destroy fossils coinciding with gaps</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>  <span class="fu">rev_dir</span>(<span class="at">ref =</span> <span class="fu">max_height</span>(adm_12km ))</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>FossilSim<span class="sc">:::</span><span class="fu">plot.fossils</span>(f_strat,</span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a>                         <span class="at">tree =</span> tree_strat,</span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a>                         <span class="at">taxonomy =</span> s_strat,</span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a>                         <span class="at">show.taxonomy =</span> <span class="cn">TRUE</span>, </span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a>                         <span class="at">rho =</span> <span class="dv">0</span>,</span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a>                         <span class="at">show.axis =</span> <span class="cn">FALSE</span>)</span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>)</span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a><span class="fu">mtext</span>(<span class="dv">1</span>, <span class="at">text =</span> <span class="st">&quot;Stratigraphic position [m]&quot;</span>, <span class="at">line =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img role="img" aria-label="Tree with fossils affected by ecological and stratigraphic effects." src="data:image/png;base64,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" alt="Tree with fossils affected by ecological and stratigraphic effects." /></p>
<p>Trees and taxonomy object are not modified by
<code>apply_niche</code> and <code>apply_taphonomy</code>, as they are
are not subject to sampling effects.</p>
</div>
<div id="technical-notes" class="section level3">
<h3>Technical notes</h3>
<p><code>FossilSim</code> uses age relative to the present, whereas
<code>admtools</code> uses time. The function
<code>admtools::rev_dir</code> accounts for this by reversing time to
age and the other way around (relative to a reference point). Use this
function on all object produced by <code>FossilSim</code> before
entering and after leaving the <code>admtools</code> and
<code>StratPal</code> ecosystem.</p>
<p>By default, axis labels of <code>FossilSim</code> are Time before
the present. In the context of <code>StratPal</code> and
<code>admtools</code> this is misleading, as the present might refer to
the end of the observation/the highest stratigraphic point. As of now,
no option to override the default axis labels are available. For correct
axis labels, set <code>show.axis = FALSE</code> and manually create the
axis using <code>axis</code> and <code>mtext</code>.</p>
</div>
</div>
<div id="integration-with-paleotree" class="section level2">
<h2>Integration with <code>paleotree</code></h2>
<p>To combine the <code>StratPal</code> package with the
<code>paleotree</code> package, please convert the
<code>paleotree</code> format into the <code>FossilSim</code> format as
described in the <code>paleotree</code> vignette of the
<code>FossilSim</code> vignette:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">vignette</span>(<span class="st">&quot;paleotree&quot;</span>, <span class="at">package =</span> <span class="st">&quot;FossilSim&quot;</span>)</span></code></pre></div>
<p>After conversion you can proceed as described in the section
<em>Integration with the <code>FossilSim</code> package</em></p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<ul>
<li>Barido-Sottani J, Pett W, OReilly JE, Warnock RCM. Fossilsim: An r
package for simulating fossil occurrence data under mechanistic models
of preservation and recovery. Methods Ecol Evol. 2019; 10: 835840. <a href="https://doi.org/10.1111/2041-210X.13170" class="uri">https://doi.org/10.1111/2041-210X.13170</a></li>
<li>Bapst, D.W. (2012), paleotree: an R package for paleontological and
phylogenetic analyses of evolution. Methods in Ecology and Evolution, 3:
803-807. <a href="https://doi.org/10.1111/j.2041-210X.2012.00223.x" class="uri">https://doi.org/10.1111/j.2041-210X.2012.00223.x</a></li>
<li>Warnock R, Barido-Sottani J, Pett W, Joseph O, Stolz U (2024).
<em>FossilSim: Simulation and Plots for Fossil and Taxonomy Data</em>. R
package version 2.4.1, <a href="https://CRAN.R-project.org/package=FossilSim" class="uri">https://CRAN.R-project.org/package=FossilSim</a></li>
</ul>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
